iOS Akademija

# Predavanja / 05


---

# Potpuno nova app: Valute

> KreÄ‡emo u novi projekat: kreiramo *konvertor valuta*. 

Bitni koraci kada se kreira nova app:

Korak pre svih koraka: *Å ta treba da radi? Ima li smisla? Ima li trÅ¾iÅ¡ta? Å ta veÄ‡ postoji?* Itd. == Market Research

Za veÅ¾banje i uÄenje, sve to moÅ¾emo da preskoÄimo. ğŸ¤— Smatramo da imamo ideju, cilj, Å¡ta treba da se uradi.

Ok, onda sada ide lista:

1. Ime
2. Ikona
3. Grubi spisak funkcionalnosti
4. Analiza potrebnih resursa
5. Analiza potrebnih ekrana za postizanje Å¾eljene funkcionalnosti
6. Dizajn
7. Opet analiza potrebnih resursa, na osnovu dizajna (ikone unutar app, grafiÄki resursi itd)

> Ne zaboravite na [iOS HIG](https://developer.apple.com/ios/human-interface-guidelines/) (Human Interface Guidelines)

> [Distribute on App Store](https://developer.apple.com/app-store/) deo na Apple Developer portalu

### Ime

NaÅ¡ konvertor Ä‡e se zvati: Valute

### App Icon

* Simpa izvedba [novÄiÄ‡a](https://dribbble.com/shots/1239917-Social-Coins)
* NepostojeÄ‡a valuta - [redizajn US dolara](https://dribbble.com/shots/2510432-American-Currency-Redesign)

Ikona je *vrlo* bitna i ima mnoÅ¡to detalja o kojima treba voditi raÄuna. Topla preporuka, kada radite ozbiljnu app: **platite dobrog dizajnera**.

* [Photoshop template](https://appicontemplate.com) za app ikone

### Spisak funkcionalnosti

* Konvertuje iz jedne valute u drugu
* OmoguÄ‡ava izbor dve valute iz liste raspoloÅ¾ivih valuta
* Unos proizvoljne decimalne vrednosti za neku od valuta

### Analiza resursa

* Currency Codes: [ISO 4127](http://www.iso.org/iso/home/standards/currency_codes.htm)
* Country Codes - [ISO 3166](http://www.iso.org/iso/country_codes/country_codes)

[iOS ima sve](https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPInternational/LanguageandLocaleIDs/LanguageandLocaleIDs.html) Å¡to nam treba:

* Spisak [valuta](https://developer.apple.com/reference/foundation/locale/2293073-commonisocurrencycodes), tj. njihovih kodova
* Spisak zemalja ([regiona](https://developer.apple.com/reference/foundation/locale/2293271-isoregioncodes))

Izvor kurseva za sve valute: [Yahoo! Finance](http://finance.yahoo.com/currency-converter/) currency converter. TaÄnije, koristiÄ‡emo njihov CSV download endpoint.

### Analiza ekrana

Tj. gruba analiza delova aplikacije koju Å¾elimo da napravimo:

Glavni ekran, sa 

- fake tastaturom
- prostorom za ispis cifara
- prostorom za ispis kodova valuta

Dodatni ekran sa

- spiskom svih valuta koji moÅ¾e da se skroluje
- text fieldom za search, tj. brzi filter kroz valute

Plus (eventualno joÅ¡) pomoÄ‡ni ekran za 

- support, 
- help
- about
itd.

### Dizajn

Sada vam treba grafiÄki dizajn za prethodno kreiranu specifikaciju. Dizajn nije samo grafika, to je pre svega User Experience (UX)

> [Apple Design Videos](https://developer.apple.com/videos/design/) - obavezno gledanje za profesionalce

Kupite gotov dizajn: https://ui8.net (i mnoga druga mesta)

> **IskljuÄivo** za veÅ¾banje i uÄenje, dobro mesto za inspiraciju je [Dribbble](https://dribbble.com/). 

Å to Ä‡e reÄ‡i - moÅ¾ete da poÄnete i od taÄke 6 ğŸ˜‡.

Recimo, za [currency](https://dribbble.com/search?q=currency) ima svaÅ¡ta.

Izbor: 

* [Vert](https://dribbble.com/shots/1707405-Vert-Unit-and-Currency-Converter)
* [Currency Converter](https://dribbble.com/shots/1692197-Currency-Converter-for-IOS) 1
* [Currency Converter](https://dribbble.com/shots/1060222-Currency-Converter) 2
* [Currency Converter](https://dribbble.com/shots/2481960-Currency-Converter) 3

PraviÄ‡emo: ovaj poslednji
![](../assets/valute/currency_converter.png)

> GrafiÄki dizajn Äesto dovede do izmene specifikacije

### Analiza resursa na osnovu dizajna

Treba nam:

- gomila sliÄica za zastave
- nekoliko UI ikonica

Gde naÄ‡i ikone?

- [https://duckduckgo.com/?q=flag+icon+set&t=osx](https://duckduckgo.com/?q=flag+icon+set&t=osx)
- [https://www.gosquared.com/resources/flag-icons/](https://www.gosquared.com/resources/flag-icons/)

- [https://github.com/mariuszostrowski/subway](https://github.com/mariuszostrowski/subway)
- [http://www.pixellove.com](http://www.pixellove.com)
- [https://www.iconfinder.com](https://www.iconfinder.com)
- [https://icons8.com](https://icons8.com)
- [https://metropolicons.com](https://metropolicons.com)
- [https://roundicons.com](https://roundicons.com)
itd.

## Å ta treba da znamo za napravimo ovu app

### Kontrole

* UIButton
* UITextField
* UIView

Napredne kontrole:

* UITableView
* UITableViewCell (custom)
* UIImage (Image Assets)

### Rad sa kontrolerima

* UIViewController i kako uÄitati novi UIVC kao rezultat neke akcije

Kompleksni kontroleri i elementi koji idu uz njih:

* UINavigationController
* UINavigationBar
* UIBarButtonItem

### System Frameworks

* URLSession & friends (rad sa mreÅ¾om)
* UserDefaults
* Locale

### Software Design Patterns

* MVC = Model View Controller
* Delegate pattern
* Singleton pattern

---

# iOS dev

Views.playground moguÄ‡e da ne radi u Xcode 8.3, pa je potrebno [haknuti](https://forums.developer.apple.com/thread/74999) malo. Zatvorite Xcode kompletno, a onda u Terminalu izvrÅ¡iti ovu liniju (sve je jedna linija):

```
defaults write com.apple.dt.xcode IDEPlaygroundDisableSimulatorAlternateFramebuffer -bool YES
```

Nakon ovoga Ä‡e raditi.

## Views

![](../assets/view-hierarchy.png)

Sve poÄinje od `UIScreen` Å¡to je reprezentacija fiziÄkog ureÄ‘aja. Sve ispod su razne varijante viewa, ukljuÄujuÄ‡i i `UIWindow` koji je niÅ¡ta drugo nego `UIView` subclass.

Koordinatni sistem za svaki view poÄinje od gornjeg levog Ä‡oÅ¡ka Å¡to predstavlja taÄku 0,0. 

![](../assets/coord-system.png)

Horizontalna osa se zove x-osa i pozitivne vrednosti x su od leve prema desnoj strani.
Vertikalna osa se zove y-osa i pozitivne vrednosti y idu od gornje prema donjoj ivici.

### Frame vs Bounds

`frame` i `bounds` su property svakog viewa i definisani su kao  struktura (`struct`) tipa `CGRect`. 

```
public struct CGRect {
    public var origin: CGPoint
    public var size: CGSize

    public init()
    public init(origin: CGPoint, size: CGSize)
}
```

`origin` se odnosi na gornji levi ugao pravougaonika, a `size` se odnosu na povrÅ¡inu.

![](../assets/frame.png)

`origin` je struktura tipa `CGPoint` i sadrÅ¾i dva property-ja `x` i `y`. size je struktura tipa `CGSize` i ima dva property-ja `width` i `height`

`CGPoint`, `CGSize` i `CGRect` su neki od osnovnih pojmova definisanih unutar Core Graphics (otuda i CG na poÄetku svih imena) frameworka. 

Napomena: preporuÄujem da se koristeÄ‡i `Command + click` proÅ¡etate malo kroz te strukture i da vidite Å¡ta sve tu ima, pre svega Å¡ta postoji od dodatnih metoda definisanim nad ovim strukturama.

Definicije:

* `frame` predstavlja poziciju i veliÄinu datog viewa u koordinatnom sistemu nadreÄ‘enog viewa (superview-a)

* `bounds` definiÅ¡e Å¡ta je vidljivi deo sadrÅ¾aja viewa. Zbog toga se kaÅ¾e da je to _viewport_ ka sadrÅ¾aju unutar viewa.

![](../assets/frame-bounds.png)

### UIScrollView

_ScrollView_ je subclass UIViewa koji ima viÅ¡e interesantnih property-ja i methoda koji omoguÄ‡avaju da se sadrÅ¾aj unutar njega pomera direktnom interakcijom; dodir + povlaÄenje == skrol

Skrolovanje se interno bazira na promeni bounds-a. Skrolovanje = menjanje `bounds.origin` za onoliko za koliko se pomerio prst.

Opet napomena: ukucajte UIScrollView bilo gde, pa Option + click na to i pogledajte Å¡ta sve od property-ja i methoda postoji.

> OdliÄan blog post: [Understanding UIScrollView](https://oleb.net/blog/2014/04/understanding-uiscrollview/) Ole Begemanna

#### Izuzetna predavanja vezana za UIScrollView sa WWDC-a

* WWDC09 / 102: Mastering iPhone Scroll Views (basics)
* [WWDC10 / 104](http://adcdownload.apple.com/videos/wwdc_2010__hd/session_104__designing_apps_with_scroll_views.mov): Designing apps with Scroll Views (photo browsing, tiling)
* [WWDC11 / 104](https://developer.apple.com/videos/play/wwdc2011/104/): Advanced ScrollView Techniques (infinite scrolling, stationary views, interaction with gestures)
* [WWDC12 / 223](https://developer.apple.com/videos/play/wwdc2012/223/): Enhancing User Experience with Scroll Views (photo browsing 2.0, scrolling with OpenGL, custom deceleration)
* [WWDC13 / 217](https://developer.apple.com/videos/play/wwdc2013/217/): Exploring Scroll Views on iOS 7 (nested scroll views, integration with dynamics)
* [WWDC14 / 235](https://developer.apple.com/videos/play/wwdc2014/235/): Advanced Scrollviews and Touch Handling Techniques

> [ASCIIWWDC](http://asciiwwdc.com) - transkripti svih sessija sa WWDC 2010-2016

> Apple [Developer Videos](https://developer.apple.com/videos/)

> WWDC / Tech Talks [videos archive](https://developer.apple.com/videos/archive/)


---

## UIViewController i .xib vs .storyboard

* Kreiranje samostalnih `.xib`/`.storyboard` fajlova
* Povezivanje sa postojeÄ‡im ViewController.swift kodom
* Instanciranje VC-a koristeÄ‡i .xib fajl ili .storyboard (u `AppDelegate.swift`, za poÄetak)

## Rad sa slikama

* `.xcassets` je preporuÄeni naÄin rada sa UI grafikama

![](../assets/asset-catalog.png)

* Pogledati Xcode 8 help: [Working with assets](http://help.apple.com/xcode/mac/8.0/#/dev10510b1f7) sajtu

Nove klase:

* [UIImage](https://developer.apple.com/reference/uikit/uiimage)

* [UIImageView](https://developer.apple.com/reference/uikit/uiimageview) 



---

# Swift

Lagani uvod u tzv. srednji nivo Swift znanja. PoÄinjemo sa protokolima, koji su delom tip podatka a delom koncept u programiranju.

## Protocols

Opis naveden u Swift Programming Language knjizi je prosto savrÅ¡en i vredi ga ponoviti:

> â€œA protocol defines a *blueprint* of methods, properties, and other requirements that suit a particular task or piece of functionality.â€

To znaÄi samo deklariÅ¡e metode kao interface ali ih ne definiÅ¡e, nema implementaciju.

> â€œThe protocol can then be *adopted* by a class, structure, or enumeration to *provide an actual implementation* of those requirements.â€

Prihvatanje protokola znaÄi da dati struct/class/enum moraju da implementiraju *meso* deklarisanih metoda.

> â€œAny type that satisfies the requirements of a protocol is said to *conform* to that protocol.â€

Evo jedan primer koji ilustruje sve bitnije stvari:

```swift
protocol PetAnimal {
	var isSuitableForIndoor: Bool { get }
}

protocol AnimalFeeding {
	var feedInterval: TimeInterval { get set }
	func feed(withFood food: FootType, amountGrams grams: Int)
}
```

`isSuitableForIndoor` je read-only property. To je zahtevani *minimum* koji mora da se ispuni, nije apsolutni zahtev. Iako liÄi na sintaksu za computed properties, protocol se uopÅ¡te ne bavi konkretnom implementacijom i to je u potpunosti ostavljeno na tipu koji prihvata protocol da definiÅ¡e.

Tako da konkretna implementacija moÅ¾e biti i uobiÄajeni get/set _stored property_, to je sve ok.

`feedInterval` je read/write property, tako da mora da se koristi property koji se i Äita i piÅ¡e.

```swift
struct Dog: PetAnimal, AnimalFeeding {
	var isSuitableForIndoor: Bool { return true }
	var feedInterval: TimeInterval = 720
	func feed(withFood food: FootType, amountGrams grams: Int) {
		//â€¦
	}
}
```

Neki drugi tip onda moÅ¾e da prihvati iste ove protokole i da ih implementira na drugaÄiji naÄin, npr:

```swift
struct Bird: PetAnimal {
	let isSuitableForIndoor: Bool
}
```

Ovo takoÄ‘e zadovoljava protocol, jer postoji property koji se moÅ¾e proÄitati.

### Primeri iz Swift Standard Library

Osobina protokola da se fokusiraju na mali ultra-fokusirani segment funkcionalnosti nam omoguÄ‡ava da deklariÅ¡emo da tipovi koji su sami po sebi potpuno razliÄiti imaju neke zajedniÄke osobine i funkcionalnosti.

Swift [Standard Library](https://developer.apple.com/reference/swift) je prepun raznoraznih protokola koji su bez dileme najÄeÅ¡Ä‡e koriÅ¡Ä‡en koncept u samom jeziku.

Oni omoguÄ‡avaju implementaciju stvari koje inaÄe uzimamo zdravo za gotovo, kao - pa to uvek postoji.

* [Equatable](https://developer.apple.com/reference/swift/equatable) - implementira jednakost vrednosti
* [Hashable](https://developer.apple.com/reference/swift/hashable) - omoguÄ‡ava brzu proveru jedinstvenosti vrednosti, putem `hashValue`
* [Comparable](https://developer.apple.com/reference/swift/comparable) â€“ implementira uporeÄ‘ivanje dve vrednosti

> Za Äitanje i gledanje: [Every Swift Value Type should be Equatable](https://www.andrewcbancroft.com/2015/07/01/every-swift-value-type-should-be-equatable/)

Znate onu lepu stvar gde moÅ¾ete koristiti `niz.first?`, `dict.count` ili `niz[4]`..? OmoguÄ‡io [Collection](https://developer.apple.com/reference/swift/collection) protokol.

Dodatna lepota zvana `for elem in ElementsArray` je moguÄ‡a zbog [Sequence](https://developer.apple.com/reference/swift/sequence) protokola.

Ili to Å¡to nam `enum` baziran na `Int` ili `String` omoguÄ‡ava da imamo automatske _fallback_ (raw) vrednosti? Hvala, [RawRepresentable](https://developer.apple.com/reference/swift/rawrepresentable) protokolu.

Itd.

### Primeri iz iOS SDK

Protokoli su postojali i ranije, u Objective-C jeziku, <small>mada su znatno manje moÄ‡ni u odnosu na ovo Äudo u Swiftu</small>. Predstavljaju kamen temeljac implementacije Delegate patterna 

[UITableViewDataSource](https://developer.apple.com/reference/uikit/uitableviewdatasource) i [UITableViewDelegate](https://developer.apple.com/reference/uikit/uitableviewdelegate) su klasiÄni primeri i viÅ¡e Ä‡emo o njima kasnije, kada budemo radili sa Table Views.

[UIApplicationDelegate](https://developer.apple.com/reference/uikit/UIApplicationDelegate) smo takoÄ‘e veÄ‡ sreli, pa pretrÄali preko njega.

